<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VipCoringa | Monitor de Views</title>
    <!-- Inclui Tailwind CSS para estilização rápida e responsiva -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Carrega a fonte 'Fira Code' do Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* Define a fonte padrão para o corpo e a cor de fundo */
        body {
            font-family: 'Fira Code', monospace;
            background-color: #0a0a0a;
        }
        /* Estilos para a caixa do terminal, adicionando uma sombra */
        .terminal {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.3);
        }
        /* Estilos para o cabeçalho do terminal */
        .terminal-header {
            height: 30px;
            border-top-left-radius: 0.5rem;
            border-top-right-radius: 0.5rem;
        }
        /* Estilos para os pontos de controle (vermelho, amarelo, verde) no cabeçalho */
        .terminal-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 6px;
        }
        /* Estilos para a área de conteúdo do terminal, adicionando uma sombra interna */
        .terminal-content {
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.5);
        }
        /* Animação de piscar para o cursor */
        .blink {
            animation: blink 1s infinite;
        }
        @keyframes blink {
            0% { opacity: 1; }
            50% { opacity: 0; }
            100% { opacity: 1; }
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4 bg-gray-900 text-gray-100">
    <!-- Título principal da página -->
    <div class="w-full max-w-4xl mx-auto mb-6">
        <h1 class="text-2xl md:text-3xl font-bold text-center text-blue-400 font-mono">
            VipCoringa <span class="text-gray-400">|</span> <span class="text-gray-300">Monitor de Views</span>
        </h1>
    </div>

    <!-- Contêiner principal do terminal -->
    <div class="terminal w-full max-w-4xl rounded-lg overflow-hidden border border-gray-700">
        <!-- Cabeçalho do terminal com os botões de controle e o endereço da fonte de dados -->
        <div class="terminal-header bg-gray-800 flex items-center px-4">
            <div class="terminal-dot bg-red-500"></div>
            <div class="terminal-dot bg-yellow-500"></div>
            <div class="terminal-dot bg-green-500"></div>
            <!-- A URL agora indica a fonte via proxy CORS -->
            <span class="text-xs ml-4 text-gray-400 hidden sm:inline">https://komarev.com/ghpvc/ (Via CORS Proxy)</span>
        </div>
        
        <!-- Área de conteúdo onde o painel formatado será exibido -->
        <div class="terminal-content bg-black p-4 md:p-6 overflow-auto max-h-[70vh]">
            <pre class="text-sm md:text-base text-green-100 font-mono whitespace-pre-wrap" id="api-content">
Carregando dados do monitor... <span class="blink">|</span>
            </pre>
        </div>
        
        <!-- Rodapé do terminal com informações de status e última atualização -->
        <div class="bg-gray-900 text-xs text-gray-500 p-2 flex justify-between items-center">
            <div>
                <span class="hidden sm:inline">Terminal</span> 
                <span class="inline sm:hidden">VipCoringa</span>
            </div>
            <div>
                <span id="last-update">Última atualização: --:--:--</span>
            </div>
        </div>
    </div>

    <script>
        // ============================================================================================================
        // ATENÇÃO: USO DE PROXY PÚBLICO CORS
        // Esta é a solução para fazer a requisição funcionar no GitHub Pages,
        // contornando o erro de CORS (Cross-Origin Resource Sharing) que a API komarev.com não permite.
        // NO ENTANTO, proxies públicos NÃO SÃO RECOMENDADOS PARA USO EM PRODUÇÃO devido a:
        // - Confiabilidade: Podem sair do ar a qualquer momento.
        // - Limites de Uso: Podem bloquear suas requisições se houver muitas.
        // - Segurança: Seus dados passam por um servidor de terceiros.
        // A MELHOR SOLUÇÃO AINDA É TER UM BACKEND PRÓPRIO (como na Vercel Functions) ou que a API de destino permita CORS.
        // ============================================================================================================

        // URL da API komarev.com que retorna as views em formato SVG.
        const originalKomarevApiUrl = 'https://komarev.com/ghpvc/?username=VipCoringa&style=for-the-badge&label=Views:&color=gray';
        
        // URL do proxy CORS público, concatenado com a URL da API real.
        // O proxy `https://corsproxy.io/` é apenas um exemplo.
        // Você pode testar outros como `https://cors-anywhere.herokuapp.com/` (com desvantagens semelhantes).
        const komarevApiUrl = `https://corsproxy.io/?${encodeURIComponent(originalKomarevApiUrl)}`;
        
        const USERNAME = 'VipCoringa'; // Seu nome de usuário para o monitor
        const ARROW = '⇧'; // Caractere de seta

        const contentElement = document.getElementById('api-content');
        const lastUpdateElement = document.getElementById('last-update');
        
        /**
         * Obtém a hora atual formatada.
         * @returns {string} A hora atual no formato HH:MM:SS.
         */
        function getHora() {
            // Adicionado timeZone: 'America/Sao_Paulo' para garantir o fuso horário correto
            return new Date().toLocaleTimeString('pt-BR', { hour12: false, timeZone: 'America/Sao_Paulo' });
        }

        /**
         * Constrói o painel de texto formatado, similar ao seu backend original.
         * @param {string} views - O número de views.
         * @param {string} status - O status do monitor.
         * @param {string} hora - A hora atual.
         * @returns {string} O painel de texto formatado.
         */
        function buildPanel(views, status, hora) {
            // Usa padEnd para garantir que as strings tenham o mesmo comprimento para o alinhamento ASCII
            return `
╔════════════════════════════════╗
║       𝙼𝙾𝙽𝙸𝚃𝙾𝚁 𝙳𝙴 𝚅𝙸𝙴𝚆𝚂       ║
╠════════════════════════════════╣
║ Usuário: ${USERNAME.padEnd(20)}║
╠════════════════════════════════╣
║ 𝚅𝙸𝙴𝚆𝚂 𝙰𝚃𝚄𝙰𝙸𝚂 : ${views.toString().padEnd(15)}║
║ 𝚂𝚃𝙰𝚃𝚄𝚂       : ${status.padEnd(15)}║
║ 𝙷𝙾𝚁𝙰́𝚁𝙸𝙾      : ${hora.padEnd(15)}║
╚════════════════════════════════╝
`.trim(); // .trim() remove espaços em branco extras no início/fim.
        }

        /**
         * Busca o número de views diretamente da API komarev.com (via proxy) e atualiza o painel.
         */
        async function fetchData() {
            try {
                // Faz a requisição para o proxy CORS, que então encaminha para a API komarev.com
                const response = await fetch(komarevApiUrl, { cache: 'no-store' });
                
                // Se a resposta do proxy não for OK, algo deu errado (o proxy pode ter falhado ou a API).
                if (!response.ok) {
                    throw new Error(`Erro na requisição (possivelmente proxy ou Komarev): ${response.status} ${response.statusText}`);
                }
                
                // A resposta é um SVG, precisamos extrair o número de views dele.
                const svgText = await response.text();
                // A expressão regular procura por 'aria-label="(?:[^"]*:: )?([0-9,]+)"' e captura o número.
                const match = svgText.match(/aria-label="(?:[^"]*:: )?([0-9,]+)/);
                
                let views = 'N/A';
                if (match && match[1]) {
                    views = match[1]; // O número de views encontrado
                } else {
                    console.warn('Não foi possível extrair o número de views do SVG.');
                }

                const hora = getHora();
                const status = `${ARROW} 𝚂𝚄𝙱𝙸𝙽𝙳𝙾`; // O status ainda é fixo.

                // Constrói o painel com os dados obtidos
                const painel = buildPanel(views, status, hora);
                contentElement.textContent = painel; // Atualiza o conteúdo do terminal
                
                updateDateTime(); // Atualiza o carimbo de data/hora da última atualização
            } catch (error) {
                const errorTime = new Date().toLocaleTimeString('pt-BR', { timeZone: 'America/Sao_Paulo' });
                contentElement.textContent = `[${errorTime}] Erro ao carregar dados: ${error.message}\nVerifique o console para mais detalhes ou tente outro proxy CORS.`;
                console.error('Erro ao buscar dados:', error);
            }
        }

        /**
         * Atualiza a exibição da data e hora da última atualização.
         */
        function updateDateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('pt-BR', { timeZone: 'America/Sao_Paulo' });
            lastUpdateElement.textContent = `Última atualização: ${timeString}`;
        }

        // Carrega os dados imediatamente e depois a cada 1 segundo
        fetchData();
        setInterval(fetchData, 1000);

        // Atualiza o horário a cada segundo para manter preciso
        updateDateTime();
        setInterval(updateDateTime, 1000);
    </script>
</body>
</html>

